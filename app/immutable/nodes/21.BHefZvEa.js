var e=Object.defineProperty,t=(t,o,s)=>((t,o,s)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[o]=s)(t,"symbol"!=typeof o?o+"":o,s);import{s as o,p as s,e as n,a as r,t as l,c as a,b as c,m as i,f as u,g as h,d as f,h as d,i as g,j as p,r as m,q as v,k as w,o as b,w as y,Y as k,n as x}from"../chunks/scheduler.BHmUeXpX.js";import{S,i as E,f as C,b as I,d as $,m as D,t as j,a as V,e as G}from"../chunks/index.DEa-WhvI.js";import{e as T}from"../chunks/each.COvwmIUk.js";import{g as N}from"../chunks/stores.Nh7Mfles.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.Cr7uR4lB.js";import{H as P,s as M}from"../chunks/HighlightCodeEditor.BOuvAYKh.js";class R{constructor(e){t(this,"workerScript"),t(this,"webWorker",null),t(this,"workerBlob"),t(this,"timeoutMS",5e3),t(this,"timeoutId",null),this.workerScript='// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-nocheck\n\nself.onmessage = async function (event) {\n  const { code, allowedGlobals } = event.data;\n  if (typeof allowedGlobals !== "string") {\n    throw new Error("allowedGlobals must be a serialized string.");\n  }\n\n  const workerScope = self;\n  const commonModules = Object.getOwnPropertyNames(workerScope).reduce((acc, key) => {\n    if (key in workerScope) {\n      const value = workerScope[key];\n      const type = typeof value;\n      if (type === "function" || type === "object") acc[key] = value;\n    }\n    return acc;\n  }, {});\n  commonModules.setTimeout = setTimeout.bind(self);\n\n  const createCustomFunction = (key, value) => {\n    return async (...args) => {\n      const argsWithoutFunction = args.filter((arg) => typeof arg !== "function");\n      self.postMessage({ type: "invoke", functionName: key, args: argsWithoutFunction });\n      await new Promise((resolve) => setTimeout(resolve, value.wait));\n    };\n  };\n\n  let commonGlobals = {};\n  let customGlobals = {};\n  try {\n    const parsedGlobals = JSON.parse(allowedGlobals);\n    for (const [key, value] of Object.entries(parsedGlobals)) {\n      if (key in commonModules) {\n        commonGlobals[key] = commonModules[key];\n      } else {\n        customGlobals[key] = createCustomFunction(key, value);\n      }\n    }\n  } catch {\n    throw new Error("Failed to parse allowedGlobals.");\n  }\n  const globals = { ...commonGlobals, ...customGlobals };\n\n  const proxy = new Proxy(globals, {\n    has: (target, key) => {\n      if (key in target) return true;\n      throw new Error(`"${String(key)}" is not exist or not allowed.`);\n    },\n    get: (target, key) => {\n      return key in target ? target[key] : undefined;\n    },\n  });\n\n  const wrappedCode = (userCode) => `\nwith (proxy) {\n  return (async () => {\n    ${userCode}\n  })(); \n}\n`;\n\n  const replacedCode = (userCode) => {\n    let replacedCode = userCode;\n    for (const key of Object.keys(customGlobals)) {\n      const regex = new RegExp(`(?<!\\\\.)\\\\b${key}\\\\b\\\\(([^)]*)\\\\)`, "g");\n      replacedCode = replacedCode.replace(regex, `await ${key}($1)`);\n    }\n    return replacedCode;\n  };\n\n  const executeCode = async () => {\n    try {\n      const result = await new Function("proxy", wrappedCode(replacedCode(code)))(proxy);\n      self.postMessage({ result });\n    } catch (error) {\n      self.postMessage({ error: error instanceof Error ? error.message : "UnknownError" });\n    }\n  };\n\n  const executeRecursiveLoop = () => {\n    executeCode().then(() => {\n      setTimeout(executeRecursiveLoop, 0);\n    });\n  };\n  executeRecursiveLoop();\n};\n',this.workerBlob=new Blob([this.workerScript],{type:"application/javascript"}),this.timeoutMS=e||this.timeoutMS}get worker(){return null===this.webWorker&&(this.webWorker=new Worker(URL.createObjectURL(this.workerBlob))),this.webWorker}run(e,t,o){this.timeoutId=setTimeout((()=>{this.worker.terminate(),console.warn("Web Worker timed out.")}),this.timeoutMS),this.worker.onmessage=e=>{this.timeoutId&&(this.timeoutId=null),this.handleWorkerMessage(e,t,o)};const s=JSON.stringify(t,((e,t)=>"function"==typeof t?t.toString():t));this.worker.postMessage({code:e,allowedGlobals:s})}formatResultToString(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e?String(e):Array.isArray(e)||"object"==typeof e?JSON.stringify(e,null,2):"(No Results)"}handleWorkerMessage(e,t,o){const{type:s,functionName:n,args:r,result:l,error:a}=e.data;if("invoke"===s){const{func:e}=t[n];"function"==typeof e&&e(...r)}else void 0!==l?o({status:"Succeed",resultString:this.formatResultToString(l),message:"Executed successfully."}):a?(console.error("Error:",a),o({status:"Error",resultString:"",message:a instanceof Error?`${a.name}: ${a.message}`:"UnknownError"})):console.warn("Unknown message type received from worker:",e.data)}terminate(){this.timeoutId&&clearTimeout(this.timeoutId),this.worker.terminate(),this.webWorker=null}}function O(e,t,o){const s=e.slice();return s[1]=t[o],s}function L(e,t,o){const s=e.slice();return s[27]=t[o],s[29]=o,s}function W(e,t,o){const s=e.slice();return s[30]=t[o],s[32]=o,s}function B(e){let t,o,s,i,m,v,b,y=e[10][e[3]]+"";return{c(){t=n("div"),o=n("div"),s=n("span"),i=l("●"),m=r(),v=n("span"),b=l(y),this.h()},l(e){t=a(e,"DIV",{class:!0});var n=c(t);o=a(n,"DIV",{class:!0});var r=c(o);s=a(r,"SPAN",{class:!0});var l=c(s);i=f(l,"●"),l.forEach(h),m=u(r),v=a(r,"SPAN",{class:!0});var d=c(v);b=f(d,y),d.forEach(h),r.forEach(h),n.forEach(h),this.h()},h(){d(s,"class",H+" text-blue-500 text-2xl"),d(v,"class",H+" text-white text-sm"),d(o,"class","relative"),d(t,"class",H)},m(e,n){g(e,t,n),p(t,o),p(o,s),p(s,i),p(o,m),p(o,v),p(v,b)},p(e,t){8&t[0]&&y!==(y=e[10][e[3]]+"")&&w(b,y)},d(e){e&&h(t)}}}function A(e){let t,o,s,l=e[8].row===e[29]&&e[8].col===e[32]&&function(){let e,t;return{c(){e=n("div"),t=n("span"),t.textContent="S",this.h()},l(o){e=a(o,"DIV",{class:!0});var s=c(e);t=a(s,"SPAN",{class:!0,"data-svelte-h":!0}),"svelte-1kggcyi"!==i(t)&&(t.textContent="S"),s.forEach(h),this.h()},h(){d(t,"class","text-blue-500"),d(e,"class",H)},m(o,s){g(o,e,s),p(e,t)},p:x,d(t){t&&h(e)}}}(),f=e[9].row===e[29]&&e[9].col===e[32]&&function(){let e,t;return{c(){e=n("div"),t=n("span"),t.textContent="G",this.h()},l(o){e=a(o,"DIV",{class:!0});var s=c(e);t=a(s,"SPAN",{class:!0,"data-svelte-h":!0}),"svelte-4qjfye"!==i(t)&&(t.textContent="G"),s.forEach(h),this.h()},h(){d(t,"class","text-blue-500"),d(e,"class",H)},m(o,s){g(o,e,s),p(e,t)},p:x,d(t){t&&h(e)}}}(),m=e[2].row===e[29]&&e[2].col===e[32]&&B(e);return{c(){t=n("div"),l&&l.c(),o=r(),f&&f.c(),s=r(),m&&m.c(),this.h()},l(e){t=a(e,"DIV",{class:!0});var n=c(t);l&&l.l(n),o=u(n),f&&f.l(n),s=u(n),m&&m.l(n),n.forEach(h),this.h()},h(){d(t,"class","relative w-10 h-10 bg-gray-200 box-border border border-gray-300"),k(t,"border-r-2",e[30].r),k(t,"border-r-black",e[30].r),k(t,"border-b-2",e[30].b),k(t,"border-b-black",e[30].b)},m(e,n){g(e,t,n),l&&l.m(t,null),p(t,o),f&&f.m(t,null),p(t,s),m&&m.m(t,null)},p(e,o){e[8].row===e[29]&&e[8].col===e[32]&&l.p(e,o),e[9].row===e[29]&&e[9].col===e[32]&&f.p(e,o),e[2].row===e[29]&&e[2].col===e[32]?m?m.p(e,o):(m=B(e),m.c(),m.m(t,null)):m&&(m.d(1),m=null)},d(e){e&&h(t),l&&l.d(),f&&f.d(),m&&m.d()}}}function U(e){let t,o,s=T(e[27]),l=[];for(let n=0;n<s.length;n+=1)l[n]=A(W(e,s,n));return{c(){t=n("div");for(let e=0;e<l.length;e+=1)l[e].c();o=r(),this.h()},l(e){t=a(e,"DIV",{class:!0});var s=c(t);for(let t=0;t<l.length;t+=1)l[t].l(s);o=u(s),s.forEach(h),this.h()},h(){d(t,"class","flex")},m(e,s){g(e,t,s);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(t,null);p(t,o)},p(e,n){if(1932&n[0]){let r;for(s=T(e[27]),r=0;r<s.length;r+=1){const a=W(e,s,r);l[r]?l[r].p(a,n):(l[r]=A(a),l[r].c(),l[r].m(t,o))}for(;r<l.length;r+=1)l[r].d(1);l.length=s.length}},d(e){e&&h(t),b(l,e)}}}function F(e){let t,o,s=e[1]+"";return{c(){t=n("span"),o=l(s),this.h()},l(e){t=a(e,"SPAN",{class:!0});var n=c(t);o=f(n,s),n.forEach(h),this.h()},h(){d(t,"class","block border border-gray-200 rounded-sm font-pixel10")},m(e,s){g(e,t,s),p(t,o)},p(e,t){1&t[0]&&s!==(s=e[1]+"")&&w(o,s)},d(e){e&&h(t)}}}function z(e){let t,o,k,x,S,E,N,M,R,W,B,A,z,H,_,q,J,Y,K,Q,X,Z,ee,te,oe,se,ne,re,le,ae,ce,ie,ue,he,fe,de,ge,pe,me,ve,we,be,ye,ke,xe='<strong class="cIndexSpan">Maze</strong>',Se="Code Editor",Ee=e[5]?"Stop":"Execute",Ce="Turns:",Ie="Logs",$e=T(e[7]),De=[];for(let s=0;s<$e.length;s+=1)De[s]=U(L(e,$e,s));function je(t){e[15](t)}let Ve={cLanguage:"language-javascript"};void 0!==e[0].code&&(Ve.code=e[0].code),J=new P({props:Ve}),s.push((()=>C(J,"code",je)));let Ge=T(e[0].logs),Te=[];for(let s=0;s<Ge.length;s+=1)Te[s]=F(O(e,Ge,s));return{c(){t=n("div"),o=n("div"),k=n("div"),x=n("div"),S=n("div"),S.innerHTML=xe,E=r(),N=n("div");for(let e=0;e<De.length;e+=1)De[e].c();M=r(),R=n("div"),W=n("div"),B=n("div"),A=n("div"),z=n("strong"),z.textContent=Se,H=r(),_=n("button"),_.textContent="✕",q=r(),I(J.$$.fragment),K=r(),Q=n("div"),X=n("button"),Z=n("div"),ee=n("span"),te=l(Ee),oe=r(),se=n("div"),ne=n("div"),re=n("div"),le=n("div"),ae=n("strong"),ae.textContent=Ce,ce=r(),ie=n("span"),ue=l(e[4]),he=r(),fe=n("div"),de=n("div"),ge=n("strong"),ge.textContent=Ie,pe=r(),me=n("button"),me.textContent="✕",ve=r(),we=n("div");for(let e=0;e<Te.length;e+=1)Te[e].c();this.h()},l(s){t=a(s,"DIV",{class:!0});var n=c(t);o=a(n,"DIV",{class:!0});var r=c(o);k=a(r,"DIV",{class:!0});var l=c(k);x=a(l,"DIV",{});var d=c(x);S=a(d,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-1a9scvh"!==i(S)&&(S.innerHTML=xe),E=u(d),N=a(d,"DIV",{class:!0});var g=c(N);for(let e=0;e<De.length;e+=1)De[e].l(g);g.forEach(h),d.forEach(h),l.forEach(h),r.forEach(h),M=u(n),R=a(n,"DIV",{class:!0});var p=c(R);W=a(p,"DIV",{class:!0});var m=c(W);B=a(m,"DIV",{});var v=c(B);A=a(v,"DIV",{class:!0});var w=c(A);z=a(w,"STRONG",{class:!0,"data-svelte-h":!0}),"svelte-1lke8zs"!==i(z)&&(z.textContent=Se),H=u(w),_=a(w,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),"svelte-1v3143d"!==i(_)&&(_.textContent="✕"),w.forEach(h),q=u(v),$(J.$$.fragment,v),v.forEach(h),K=u(m),Q=a(m,"DIV",{class:!0});var b=c(Q);X=a(b,"BUTTON",{type:!0,class:!0});var y=c(X);Z=a(y,"DIV",{class:!0});var C=c(Z);ee=a(C,"SPAN",{});var I=c(ee);te=f(I,Ee),I.forEach(h),C.forEach(h),y.forEach(h),b.forEach(h),m.forEach(h),p.forEach(h),oe=u(n),se=a(n,"DIV",{class:!0});var D=c(se);ne=a(D,"DIV",{class:!0});var j=c(ne);re=a(j,"DIV",{});var V=c(re);le=a(V,"DIV",{class:!0});var G=c(le);ae=a(G,"STRONG",{"data-svelte-h":!0}),"svelte-bln84g"!==i(ae)&&(ae.textContent=Ce),ce=u(G),ie=a(G,"SPAN",{});var T=c(ie);ue=f(T,e[4]),T.forEach(h),G.forEach(h),V.forEach(h),he=u(j),fe=a(j,"DIV",{});var P=c(fe);de=a(P,"DIV",{class:!0});var O=c(de);ge=a(O,"STRONG",{class:!0,"data-svelte-h":!0}),"svelte-r5pkvh"!==i(ge)&&(ge.textContent=Ie),pe=u(O),me=a(O,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),"svelte-24816r"!==i(me)&&(me.textContent="✕"),O.forEach(h),ve=u(P),we=a(P,"DIV",{class:!0});var L=c(we);for(let e=0;e<Te.length;e+=1)Te[e].l(L);L.forEach(h),P.forEach(h),j.forEach(h),D.forEach(h),n.forEach(h),this.h()},h(){d(S,"class","flex justify-between ml-2"),d(N,"class","bg-gray-400 border border-gray-500 p-4"),d(k,"class","flex flex-col justify-center items-center"),d(o,"class","col-span-1"),d(z,"class","cIndexSpan"),d(_,"type","submit"),d(_,"class","relative z-30"),d(A,"class","flex justify-between ml-2"),d(Z,"class","cButtonSpan"),d(X,"type","submit"),d(X,"class","cIconButtonStyle relative"),d(Q,"class","pt-2"),d(W,"class","flex flex-col justify-center items-center space-y-1"),d(R,"class","col-span-1"),d(le,"class","flex justify-between ml-2 space-x-1"),d(ge,"class","cIndexSpan"),d(me,"type","submit"),d(me,"class","relative z-30"),d(de,"class","flex justify-between ml-2"),d(we,"class","w-96 h-40 p-4 border border-gray-500 bg-gray-100 rounded-md space-y-1 overflow-y-auto"),d(ne,"class","flex flex-col justify-cetnter items-center space-y-1"),d(se,"class","col-span-1"),d(t,"class","grid grid-cols-1 lg:grid-cols-3 justify-center items-top gap-4 m-4")},m(s,n){g(s,t,n),p(t,o),p(o,k),p(k,x),p(x,S),p(x,E),p(x,N);for(let e=0;e<De.length;e+=1)De[e]&&De[e].m(N,null);p(t,M),p(t,R),p(R,W),p(W,B),p(B,A),p(A,z),p(A,H),p(A,_),p(B,q),D(J,B,null),p(W,K),p(W,Q),p(Q,X),p(X,Z),p(Z,ee),p(ee,te),p(t,oe),p(t,se),p(se,ne),p(ne,re),p(re,le),p(le,ae),p(le,ce),p(le,ie),p(ie,ue),p(ne,he),p(ne,fe),p(fe,de),p(de,ge),p(de,pe),p(de,me),p(fe,ve),p(fe,we);for(let e=0;e<Te.length;e+=1)Te[e]&&Te[e].m(we,null);e[16](we),be=!0,ye||(ke=[m(_,"click",e[12]),m(X,"click",e[11]),m(me,"click",e[13])],ye=!0)},p(e,t){if(1932&t[0]){let o;for($e=T(e[7]),o=0;o<$e.length;o+=1){const s=L(e,$e,o);De[o]?De[o].p(s,t):(De[o]=U(s),De[o].c(),De[o].m(N,null))}for(;o<De.length;o+=1)De[o].d(1);De.length=$e.length}const o={};if(!Y&&1&t[0]&&(Y=!0,o.code=e[0].code,v((()=>Y=!1))),J.$set(o),(!be||32&t[0])&&Ee!==(Ee=e[5]?"Stop":"Execute")&&w(te,Ee),(!be||16&t[0])&&w(ue,e[4]),1&t[0]){let o;for(Ge=T(e[0].logs),o=0;o<Ge.length;o+=1){const s=O(e,Ge,o);Te[o]?Te[o].p(s,t):(Te[o]=F(s),Te[o].c(),Te[o].m(we,null))}for(;o<Te.length;o+=1)Te[o].d(1);Te.length=Ge.length}},i(e){be||(j(J.$$.fragment,e),be=!0)},o(e){V(J.$$.fragment,e),be=!1},d(o){o&&h(t),b(De,o),G(J),b(Te,o),e[16](null),ye=!1,y(ke)}}}const H="absolute inset-0 flex items-center justify-center";function _(e){return{r:1===parseInt(e[0]),b:1===parseInt(e[1])}}function q(e,t,o){const n=new R(6e4);let{codeExeProps:r}=t;const l=[["10","00","01","01","00","01","00","01","01"],["10","01","01","11","10","10","01","10","00"],["10","01","01","01","10","10","10","10","00"],["01","01","01","01","10","10","10","10","00"],["00","00","01","01","10","10","10","10","00"],["10","01","01","10","01","01","10","10","00"],["10","00","11","10","00","01","01","01","01"],["10","00","01","11","01","01","01","01","00"],["10","00","00","00","00","00","00","00","00"]],a=l.map((e=>e.map(_))),c={row:l.length-1,col:0},i={row:0,col:l[0].length-1};let u={row:l.length-1,col:0};let h="up",f=0;const d={log:{func:g,wait:0},goStraight:{func:p,wait:1e3},turnRight:{func:function(){o(3,h={up:"right",right:"down",down:"left",left:"up"}[h]),o(4,f++,f)},wait:1e3},turnLeft:{func:function(){o(3,h={up:"left",left:"down",down:"right",right:"up"}[h]),o(4,f++,f)},wait:1e3}};function g(e){const t=`[${(new Date).toLocaleTimeString()}] ${e}`;o(0,r.logs=[...r.logs,t],r),w&&w.scrollTo({top:w.scrollHeight,behavior:"smooth"})}function p(){var e;const t={up:{row:-1,col:0,wall:"b",checkCurrentCell:!1},down:{row:1,col:0,wall:"b",checkCurrentCell:!0},left:{row:0,col:-1,wall:"r",checkCurrentCell:!1},right:{row:0,col:1,wall:"r",checkCurrentCell:!0}}[h];if(!t)return void g("goStraight(): Invalid direction.");const s=u.row+t.row,r=u.col+t.col,l=a[u.row][u.col],c=null==(e=a[s])?void 0:e[r];s>=0&&s<a.length&&r>=0&&r<a[0].length&&(t.checkCurrentCell?!l[t.wall]:!c[t.wall])?o(2,u={row:s,col:r}):g(`goStraight(): Can't move ${h}.`),u.row===i.row&&u.col===i.col&&(g("Reached Goal!"),v.trigger(M("Goal!!","Succeed")),o(5,m=!1),n.terminate()),o(4,f++,f)}let m=!1;const v=N();let w;return e.$$set=e=>{"codeExeProps"in e&&o(0,r=e.codeExeProps)},[r,g,u,h,f,m,w,a,c,i,{up:"⬆",down:"⬇",left:"⬅",right:"➡️"},function(){m?(o(5,m=!1),n.terminate()):(o(5,m=!0),n.run(r.code,{...d},(e=>{o(0,r.resultString=e.resultString,r),v.trigger(M(e.message,e.status))})))},function(){o(0,r.code="",r)},function(){o(0,r.logs=[],r)},p,function(t){e.$$.not_equal(r.code,t)&&(r.code=t,o(0,r))},function(e){s[e?"unshift":"push"]((()=>{w=e,o(6,w)}))}]}class J extends S{constructor(e){super(),E(this,e,q,z,o,{codeExeProps:0,log:1,goStraight:14},null,[-1,-1])}get log(){return this.$$.ctx[1]}get goStraight(){return this.$$.ctx[14]}}function Y(e){let t,o,r,l;function i(t){e[3](t)}let u={};return void 0!==e[1]&&(u.codeExeProps=e[1]),o=new J({props:u}),e[2](o),s.push((()=>C(o,"codeExeProps",i))),{c(){t=n("div"),I(o.$$.fragment),this.h()},l(e){t=a(e,"DIV",{class:!0});var s=c(t);$(o.$$.fragment,s),s.forEach(h),this.h()},h(){d(t,"class","cRouteBodyStyle")},m(e,s){g(e,t,s),D(o,t,null),l=!0},p(e,[t]){const s={};!r&&2&t&&(r=!0,s.codeExeProps=e[1],v((()=>r=!1))),o.$set(s)},i(e){l||(j(o.$$.fragment,e),l=!0)},o(e){V(o.$$.fragment,e),l=!1},d(s){s&&h(t),e[2](null),G(o)}}}function K(e,t,o){let n,r={allowedGlobals:{},code:"let loops = 0\nwhile (true) {\n  for (let i = 0; i < 4; i++) {\n    goStraight();\n  }\n  if (loops % 2 === 0) {\n    turnRight();\n  } else {\n    turnLeft();\n  }\n  loops += 1\n}",resultString:"",logs:[]};return[n,r,function(e){s[e?"unshift":"push"]((()=>{n=e,o(0,n)}))},function(e){r=e,o(1,r)}]}class Q extends S{constructor(e){super(),E(this,e,K,Y,o,{})}}export{Q as component};
